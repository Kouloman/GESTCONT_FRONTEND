import{r as n,d as p,i as u,e as o,R as e,L as b}from"./index-wFRW0Cer.js";import{F as j,c as A,a as $,b as E,E as N,g as M,d as v}from"./index.esm-DEY0XWA5.js";import{P as q}from"./plus-CIhHIK3R.js";import{C as D}from"./check-Cvo7CuuM.js";import{X as L,S as G,T as P}from"./x-DcsFHoIM.js";import"./index-Ch8__LMA.js";const R=A().shape({code:v().matches(/^[0-9]{2}[A-Z][0-9]$/,"Format invalide. Ex: 22G1").required("Le code est requis"),description:v().required("La description est requise"),active:M()}),H=()=>{const[c,l]=n.useState([]),[w,f]=n.useState(!0),[S,i]=n.useState(!1),[a,d]=n.useState(null),[y,h]=n.useState(!1),[I,x]=n.useState(null);n.useEffect(()=>{k()},[]);const k=async()=>{f(!0);try{try{const t=await p.get("/iso-codes");l(t.data)}catch{{const r=await u.getAll();l(r)}}}catch{o.error("Erreur lors du chargement des codes ISO")}finally{f(!1)}},C=()=>{d(null),i(!0)},O=t=>{d(t),i(!0)},F=async t=>{try{try{await p.delete(`/iso-codes/${t}`)}catch(r){if(r.isMockable)await u.delete(t);else throw r}o.success("Code ISO supprimé avec succès"),l(c.filter(r=>r.id!==t))}catch{o.error("Erreur lors de la suppression du code ISO")}finally{x(null)}},z=async(t,{resetForm:r})=>{h(!0);try{if(t.code=t.code.toUpperCase(),a){try{const s=await p.put(`/iso-codes/${a.id}`,t);l(c.map(m=>m.id===a.id?s.data:m))}catch(s){if(s.isMockable){const m=await u.update(a.id,t);l(c.map(g=>g.id===a.id?m:g))}else throw s}o.success("Code ISO mis à jour avec succès")}else{try{const s=await p.post("/iso-codes",t);l([...c,s.data])}catch(s){if(s.isMockable){const m=await u.create(t);l([...c,m])}else throw s}o.success("Code ISO créé avec succès")}i(!1),d(null),r()}catch{o.error("Erreur lors de l'enregistrement du code ISO")}finally{h(!1)}};return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h1",{className:"text-2xl font-bold text-gray-800"},"Gestion des codes ISO"),e.createElement("p",{className:"text-gray-600"},"Créez et gérez les codes ISO des conteneurs")),e.createElement("button",{onClick:C,className:"btn btn-primary flex items-center"},e.createElement(q,{size:18,className:"mr-2"}),"Nouveau code ISO")),S&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 animate-fadeIn"},e.createElement("h2",{className:"text-xl font-semibold text-gray-800 mb-6"},a?"Modifier le code ISO":"Nouveau code ISO"),e.createElement(j,{initialValues:{code:(a==null?void 0:a.code)||"",description:(a==null?void 0:a.description)||"",active:(a==null?void 0:a.active)??!0},validationSchema:R,onSubmit:z},({isSubmitting:t})=>e.createElement($,{className:"space-y-4"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{htmlFor:"code",className:"form-label"},"Code ISO"),e.createElement(E,{type:"text",id:"code",name:"code",className:"form-input uppercase",placeholder:"Ex: 22G1"}),e.createElement(N,{name:"code",component:"div",className:"text-red-500 text-xs mt-1"})),e.createElement("div",null,e.createElement("label",{htmlFor:"description",className:"form-label"},"Description"),e.createElement(E,{type:"text",id:"description",name:"description",className:"form-input",placeholder:"Ex: 20' General Purpose"}),e.createElement(N,{name:"description",component:"div",className:"text-red-500 text-xs mt-1"})),e.createElement("div",{className:"flex items-center"},e.createElement(E,{type:"checkbox",id:"active",name:"active",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.createElement("label",{htmlFor:"active",className:"ml-2 text-sm text-gray-700"},"Actif"))),e.createElement("div",{className:"flex justify-end space-x-3 pt-4"},e.createElement("button",{type:"button",onClick:()=>{i(!1),d(null)},className:"btn btn-outline"},"Annuler"),e.createElement("button",{type:"submit",disabled:y||t,className:"btn btn-primary flex items-center justify-center min-w-[120px]"},y?e.createElement(b,{size:"small"}):"Enregistrer"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden animate-fadeIn"},w?e.createElement("div",{className:"py-12 flex justify-center"},e.createElement(b,null)):e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Code"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},c.length===0?e.createElement("tr",null,e.createElement("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500"},"Aucun code ISO trouvé")):c.map(t=>e.createElement("tr",{key:t.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},t.code)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm text-gray-900"},t.description)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},t.active?"Actif":"Inactif")),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},I===t.id?e.createElement("div",{className:"flex items-center justify-end space-x-2"},e.createElement("span",{className:"text-sm text-gray-600 mr-2"},"Confirmer?"),e.createElement("button",{onClick:()=>F(t.id),className:"text-red-600 hover:text-red-900 p-1"},e.createElement(D,{size:18})),e.createElement("button",{onClick:()=>x(null),className:"text-gray-600 hover:text-gray-900 p-1"},e.createElement(L,{size:18}))):e.createElement("div",{className:"flex items-center justify-end space-x-2"},e.createElement("button",{onClick:()=>O(t),className:"text-blue-600 hover:text-blue-900 p-1"},e.createElement(G,{size:18})),e.createElement("button",{onClick:()=>x(t.id),className:"text-red-600 hover:text-red-900 p-1"},e.createElement(P,{size:18}))))))))))};export{H as default};
