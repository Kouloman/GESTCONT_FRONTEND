import{r as n,d as u,h as p,e as i,R as e,L as N}from"./index-wFRW0Cer.js";import{F as L,c as $,a as M,b as E,E as b,g as q,d as v}from"./index.esm-DEY0XWA5.js";import{P as I}from"./plus-CIhHIK3R.js";import{C as D}from"./check-Cvo7CuuM.js";import{X as P,S as O,T as R}from"./x-DcsFHoIM.js";import"./index-Ch8__LMA.js";const T=$().shape({name:v().required("Le nom est requis"),code:v().max(3,"Le code doit contenir 3 caractères maximum").matches(/^[A-Z]+$/,"Le code doit être en majuscules").required("Le code est requis"),active:q()}),H=()=>{const[c,l]=n.useState([]),[w,f]=n.useState(!0),[S,o]=n.useState(!1),[a,d]=n.useState(null),[y,h]=n.useState(!1),[k,x]=n.useState(null);n.useEffect(()=>{C()},[]);const C=async()=>{f(!0);try{try{const t=await u.get("/shipping-lines");l(t.data)}catch{{const s=await p.getAll();l(s)}}}catch{i.error("Erreur lors du chargement des armateurs")}finally{f(!1)}},A=()=>{d(null),o(!0)},F=t=>{d(t),o(!0)},j=async t=>{try{try{await u.delete(`/shipping-lines/${t}`)}catch(s){if(s.isMockable)await p.delete(t);else throw s}i.success("Armateur supprimé avec succès"),l(c.filter(s=>s.id!==t))}catch{i.error("Erreur lors de la suppression de l'armateur")}finally{x(null)}},z=async(t,{resetForm:s})=>{h(!0);try{if(t.code=t.code.toUpperCase(),a){try{const r=await u.put(`/shipping-lines/${a.id}`,t);l(c.map(m=>m.id===a.id?r.data:m))}catch(r){if(r.isMockable){const m=await p.update(a.id,t);l(c.map(g=>g.id===a.id?m:g))}else throw r}i.success("Armateur mis à jour avec succès")}else{try{const r=await u.post("/shipping-lines",t);l([...c,r.data])}catch(r){if(r.isMockable){const m=await p.create(t);l([...c,m])}else throw r}i.success("Armateur créé avec succès")}o(!1),d(null),s()}catch{i.error("Erreur lors de l'enregistrement de l'armateur")}finally{h(!1)}};return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h1",{className:"text-2xl font-bold text-gray-800"},"Gestion des armateurs"),e.createElement("p",{className:"text-gray-600"},"Créez et gérez les armateurs de conteneurs")),e.createElement("button",{onClick:A,className:"btn btn-primary flex items-center"},e.createElement(I,{size:18,className:"mr-2"}),"Nouvel armateur")),S&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 animate-fadeIn"},e.createElement("h2",{className:"text-xl font-semibold text-gray-800 mb-6"},a?"Modifier l'armateur":"Nouvel armateur"),e.createElement(L,{initialValues:{name:(a==null?void 0:a.name)||"",code:(a==null?void 0:a.code)||"",active:(a==null?void 0:a.active)??!0},validationSchema:T,onSubmit:z},({isSubmitting:t})=>e.createElement(M,{className:"space-y-4"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{htmlFor:"name",className:"form-label"},"Nom de l'armateur"),e.createElement(E,{type:"text",id:"name",name:"name",className:"form-input"}),e.createElement(b,{name:"name",component:"div",className:"text-red-500 text-xs mt-1"})),e.createElement("div",null,e.createElement("label",{htmlFor:"code",className:"form-label"},"Code (3 lettres max)"),e.createElement(E,{type:"text",id:"code",name:"code",className:"form-input uppercase",maxLength:3}),e.createElement(b,{name:"code",component:"div",className:"text-red-500 text-xs mt-1"})),e.createElement("div",{className:"flex items-center"},e.createElement(E,{type:"checkbox",id:"active",name:"active",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.createElement("label",{htmlFor:"active",className:"ml-2 text-sm text-gray-700"},"Actif"))),e.createElement("div",{className:"flex justify-end space-x-3 pt-4"},e.createElement("button",{type:"button",onClick:()=>{o(!1),d(null)},className:"btn btn-outline"},"Annuler"),e.createElement("button",{type:"submit",disabled:y||t,className:"btn btn-primary flex items-center justify-center min-w-[120px]"},y?e.createElement(N,{size:"small"}):"Enregistrer"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden animate-fadeIn"},w?e.createElement("div",{className:"py-12 flex justify-center"},e.createElement(N,null)):e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nom"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Code"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),e.createElement("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},c.length===0?e.createElement("tr",null,e.createElement("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500"},"Aucun armateur trouvé")):c.map(t=>e.createElement("tr",{key:t.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},t.name)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm text-gray-900"},t.code)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},t.active?"Actif":"Inactif")),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},k===t.id?e.createElement("div",{className:"flex items-center justify-end space-x-2"},e.createElement("span",{className:"text-sm text-gray-600 mr-2"},"Confirmer?"),e.createElement("button",{onClick:()=>j(t.id),className:"text-red-600 hover:text-red-900 p-1"},e.createElement(D,{size:18})),e.createElement("button",{onClick:()=>x(null),className:"text-gray-600 hover:text-gray-900 p-1"},e.createElement(P,{size:18}))):e.createElement("div",{className:"flex items-center justify-end space-x-2"},e.createElement("button",{onClick:()=>F(t),className:"text-blue-600 hover:text-blue-900 p-1"},e.createElement(O,{size:18})),e.createElement("button",{onClick:()=>x(t.id),className:"text-red-600 hover:text-red-900 p-1"},e.createElement(R,{size:18}))))))))))};export{H as default};
